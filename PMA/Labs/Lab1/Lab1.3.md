## Lab 1-3: Analyzing Lab01-03.exe

### Questions:

1. Upload the `Lab01-03.exe` file to [VirusTotal](http://www.VirusTotal.com/). Does it match any existing antivirus definitions?
    - First derive the hash of `Lab01-03.exe`:	
            - MD5: `9c5c27494c28ed0b14853b346b113145`
            - SHA1: `290ab6f431f46547db2628c494ce615d6061ceb8`	
            - CRC32: `b2164101`	
            - SHA256: `7983a582939924c70e3da2da80fd3352ebc90de7b8c4c427d484ff4f050f0aec`	
            - SHA512: `38741bd024904f21d424254c1fbb3c16c6925d60b34d85f9cecff5d973c6c823b6b5e5e6173926a8691b9c70dcb10575af5b5704acea4f7846e7c46b89437141`	
            - SHA384: `f9779784317b2e88af7db0a67d48c14433f42b453d0fbd851b4a43a14e35d774fcc47e6c1cc7ab633543cc53a5b99325`
        - VirusTotal
            - The file was flagged by 68/74 security vendors
        - Hybrid-Analysis
            - Flagged as malicious

2. Are there any indications that this file is packed or obfuscated? If so, what are the indicators? If the file is packed, try to unpack it if possible.

    <ins>Detection</ins>
    - Using `CFF Explorer`, the executable's file info (signature) was revealed as `FSG v1.00 (Eng) -> dulek/xt`, which suggests it being packed by the `FSG` packer.
    - Using `PEiD`, it was revealed that the executable has been packed using the `FSG 1.0 -> dulek/xt` packer.
    - `PE Studio` highlighted the missing/altered DOS message, which suggests the presence of obfuscation or the use of a packer.
    - Executable's section headers are empty, without the presence of normal conventional section headers like `.text`.
    - There is a mismatch in the virtual size and raw data size of the executable's sections
    - Missing executable section in the executable.
    - Relatively small number of imports (2), which raises suspicions on it being packed. The executable only imports the `LoadLibraryA` and `GetProcAddress` functions from the `Kernel21.dll`, which is a tell-tale sign of a packed program, which only uses these functions for subsequent unpacking when delivering its payload.
    - Suspiciously small amount of strings found in the executable.

    <ins>Unpacking</ins>
    - Attempted to unpack the `FSG` packed executable using [Unipacker](https://github.com/unipacker/unipacker), but was the tool didn't manage to successfully unpack the malware.
    - Reverse engineering efforts are required to unpack the malware.

3. Do any imports suggest the programâ€™s functionality? If so, which imports are they, and what do they reveal?
    - At this stage, we are unable to glean into the malware's functionalities due to the inability to unpack it. To be explored in later stages!

4. What host- or network-based indicators could be used to identify this malware on infected machines?
    - Without unpacking the malware, we are unable to comment on the indicators of this particular malware. However, preliminary indications could include the use of the `FSG 1.0 -> dulek/xt` packer.
    - **Revision**: Presence of OLE related strings
        ```
        ole32.vd
        }OLEAUTLA
        ```

## References
- [Sample Solutions](https://github.com/SafeEval/practical-malware-analysis/blob/master/exercises/lab-01-3.md)
- [Unipacker](https://github.com/unipacker/unipacker) (unpacker tool)
- [How to use Unipacker](https://www.youtube.com/watch?v=ee5_JUIEf8Q&ab_channel=Prof.ChrisDietrich) video
- [Chinese Forum](https://www.52pojie.cn/thread-886615-1-1.html#:~:text=%E4%BB%8A%E5%A4%A9%E9%81%87%E5%88%B0%E4%B8%80%E4%B8%AAfsg)